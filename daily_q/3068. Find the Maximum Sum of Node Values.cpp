#include <algorithm>
#include <vector>
#include <iostream>
#include <numeric>
#include <tuple>
#include <unordered_set>

using namespace std;


long long maximumValueSum(vector<int>& nums, int k, vector<vector<int>>& edges) {
    typedef long long ll;
    ll rs {accumulate(nums.begin(), nums.end(), 0)};
    vector<ll> xored {};
    for (const auto& el: nums) {
        xored.push_back((el^k)-el);
    }
    ranges::sort(xored, ranges::greater());

    ll extr {0};
    int num_pos {0};
    size_t last_ind {0};
    auto xored_size {xored.size()};


    for (size_t ind {0}; ind < xored_size; ind+=2) {
        last_ind = ind;
        if (extr=xored[ind]+xored[ind+1]; extr > 0) {
            if (xored[ind] > 0)
                ++num_pos;
            if (xored[ind+1] > 0)
                ++num_pos;

            rs += extr;
        } else {

            break;
        }
    }
    if (auto cond {num_pos % 2};  cond == 1 && xored[last_ind] > 0)
        rs -= xored[last_ind];



    return rs;
}

int main() {
    vector<tuple<vector<int>, int, vector<vector<int>>>> tests {
        // {{1,2,1}, 3, {{0,1}, {0,2}}},
        // {{2,3}, 7, {{0,1}}},
        // {{7,7,7,7,7,7}, 3, {{0,1}, {0,2}, {0,3}, {0,4}, {0,5}}},
        {{24,78,1,97,44}, 6, {{0,2},{1,2},{4,2},{3,4}}},
        // {{311,604,347,263,126,142,921,472,879,562,441,278,319,75,593,738,70,88,952,533,929,250,950,656,550,335,995,679,489,295,598,452,835,667,780,35,453,59,419,934,970,466,829,772,319,696,901,662,199,800,962,733,375,955,64,464,253,157,217,357,495,77,896,442,396,281,664,617,124,864,177,711,788,620,948,592,45,814,819,16,850,742,652,212,484,74,689,185,386,464,261,307,351,540,184,682,643,724,723,738,818,81,177,108,275,778,251,164,815,289,932,728,908,460,686,659,921,88,203,753,115,748,123,659,591,217,585,758,251,250,778,619,301,625,911,56,17,681,78,206,423,213,86,457,482,857,616,774,121,346,889,247,884,164,390,966,131,22,114,641,697,805,140,795,611,148,111,532,818,258,189,81,111,227,34,180,233,280,704,498,342,523,323,545,783,369,594,364,442,505,318,495,123,17,138,40,24,586,108,546,879,653,720,40,635,783,645,854,243,182,719,215,357,512,674,513,545,178,526,234,753,409,640,903,576,700,556,630,686,770,74,319,684,330,243,696,793,969,629,912,573,439,461,680,485,985,989,966,255,992,51,280,171,187,266,856,836,476,977,880,170,71,625,726,233,578,368,977,928,603,210,989,754,522,823,706,251,844,508,534,524,491,23,91,522,134,463,497,858,655,967,610,962,574,761,690,839,223,513,484,647,915,152,577,687,464,93,618,43,911,108,345,320,365,652,538,761,945,145,476,470,168,100,190,601,28,148,72,306,37,859,367,366,396,613,392,92,474,28,496,89,280,483,103,512,434,148,52,964,647,77,271,483,916,588,735,255,663,412,268,609,493,208,999,939,858,708,239,810,96,719,701,684,836,575,358,47,368,201,532,513,971,272,897,35,531,915,869,168,938,725,283,568,856,758,350,386,784,60,985,449,642,658,33,598,870,526,334,108,773,214,776,964,882,700,320,154,940,495,625,526,687,565,945,951,260,465,735,398,978,377,552,865,977,589,578,720,553,459,403,184,634,940,829,208,631,814,315,770,24,157,409,769,663,860,207,923,722,898,58,141,317,972,571,521,896,16,103,365,575,338,496,90,206,761,567,955,695,49,824,966,536,73,589,973,218,762,406,968,538,782,573,292,826,646,397,401,302,408,330,990,135,939,312,39,438,559,541,88,89,681,788,102,534,101,973,558,482,356,43,809,715,96,526,980,175,461,809,464,255,465,579,575,151,995,489,995,64,814,83,423,332,313,708,543,867,197,668,958,632,184,482,122,459,896,701,983,37,32,413,696,300,413,430,160,215,411,744,411,966,653,569,602,339,867,443,548,344,627,555,253,225,250,957,119,883,723,267,692,977,405,956,651,134,314,337,232,198,247,951,440,68,994,487,250,739,685,845,265,951,777,659,289,951,73,346,298,675,916,77,935,764,330,640,350,221,490,460,316,369,939,749,327,563,431,562,465,462,565,925,383,147,416,800,440,178,230,385,212,459,326,249,548,88,211,527,656,796,992,665,124,978,796,933,102,829,577,133,862,590,330,51,871,277,198,795,640,660,624,371,110,274,310,911,417,566,620,400,404,267,274,115,472,796,102,284,886,760,440,553,278,373,151,805,752,79,161,17,766,395,876,861,858,222,933,836,711,333,817,347,768,744,121,156,75,34,416,72,643,553,465,815,620,582,857,855,321,75,224,365,359,428,225,792,519,427,107,894,723,991,597,577,36,851,929,793,676,717,936,363,548,320,726,107,465,73,80,771,304,35,213,848,989,414,714,394,682,618,827,509,511,234,67,875,534,388,364,523,56,510,232,29,766,817,296,463,827,930,337,518,558,76,763,346,261,623,738,427,566,999,782,463,928,266,327,642,154,362,489,249,332,653,989,437,890,230,834,123,455,179,802,483,388,295,51,530,692,801,174,884,968,118,588,921,745,418,930,511,650,471,241,885,37,832,407,425,149,842,252,316,790,133,597,666,988,617,597,74,990,534,969,98,535,243,886,743,610,584,508,256,628,271,815,984,950,544,315,900,323,98,828,947,85,633,685,97,20,579,283,62,277,912,67,696,385,340,751,692,215,827,948,793,354,521,417,667,916,559,398,775,156,397,714,996,219,112,782,976,473,310,203,324,453,998,943,452,873,339,684,27,543,774,978,250,20,490,230,935,177,33,377,548,837,893,195,675,945,444,333,526,908,962,382,196,527,187,331,836,790,321,21,883,20,24,866,36,384,162,662,990,930,154,755,343,155,184,888,977,914,55,768,804,262,126,859,361,68,439,171,658,171,16,33,703,771,331,300,494,64,722,705,817,738,336,675,353,393,723,457,902,770,674,905,508,622,731,36,348,315,362,576,795,133,779,97,1000,474,391,904,715,869,150,22,524,673,55,420,453,549,364,243,17,38,552,576,241,737,629,47,554,407,300,329,107,782,514,364,380,206,893,670,446,188,419,283,864,737,159,702}, 1137, {{0,105},{525,3},{19,6},{548,9},{12,690},{475,14},{10,18},{853,19},{22,120},{697,30},{38,700},{39,888},{42,89},{844,43},{49,323},{991,58},{967,59},{165,60},{64,839},{65,860},{545,68},{968,69},{73,110},{433,75},{245,76},{160,77},{998,80},{203,84},{634,85},{86,1003},{632,90},{93,242},{94,520},{430,98},{460,102},{594,114},{115,496},{116,870},{118,645},{606,122},{918,123},{57,124},{130,886},{131,447},{982,134},{917,137},{139,500},{491,142},{145,481},{146,569},{599,148},{149,832},{154,496},{377,155},{309,156},{162,462},{163,328},{245,169},{272,171},{172,758},{321,174},{175,216},{178,953},{867,180},{300,189},{620,190},{191,987},{469,195},{885,198},{931,200},{204,764},{205,941},{107,208},{554,209},{215,274},{218,1056},{222,342},{812,223},{226,1032},{228,921},{649,229},{35,230},{686,35},{95,231},{799,95},{232,309},{719,233},{281,239},{530,240},{55,241},{276,55},{244,968},{245,628},{246,339},{250,680},{251,496},{253,842},{255,464},{700,256},{960,257},{815,261},{791,266},{28,267},{600,28},{580,269},{270,1033},{315,275},{786,276},{277,702},{280,106},{106,958},{50,282},{263,50},{263,252},{252,749},{283,81},{441,285},{288,958},{52,289},{290,937},{694,292},{962,295},{113,297},{915,113},{303,763},{304,706},{824,310},{623,312},{319,108},{342,321},{323,868},{324,948},{345,326},{17,329},{330,726},{110,331},{332,961},{333,627},{335,385},{1003,336},{928,339},{340,930},{344,562},{704,350},{351,325},{962,325},{352,959},{354,766},{356,105},{286,362},{591,366},{168,367},{168,165},{368,824},{369,641},{371,446},{337,373},{161,337},{375,341},{341,161},{427,377},{725,378},{380,559},{383,221},{316,384},{1061,386},{391,108},{392,685},{713,394},{397,456},{398,980},{327,399},{408,934},{40,411},{419,1067},{807,426},{429,693},{698,434},{531,436},{886,439},{365,440},{668,365},{612,443},{192,445},{446,551},{448,622},{431,458},{23,431},{516,459},{462,374},{374,708},{396,465},{63,396},{472,797},{479,493},{151,481},{342,482},{342,477},{273,477},{546,483},{725,484},{876,485},{489,508},{490,890},{491,125},{125,569},{496,600},{224,497},{224,238},{238,575},{499,210},{902,502},{1075,503},{471,505},{883,510},{511,144},{144,500},{24,500},{24,112},{112,403},{513,349},{837,514},{515,79},{518,453},{453,565},{104,521},{56,104},{469,56},{805,522},{1069,523},{524,235},{320,235},{455,320},{455,281},{281,963},{529,452},{372,452},{533,427},{427,1010},{758,535},{536,268},{449,268},{449,1069},{893,537},{539,48},{540,87},{541,661},{905,542},{543,592},{544,487},{847,487},{545,108},{108,680},{546,504},{504,260},{548,1049},{550,447},{948,447},{361,551},{51,361},{553,70},{70,480},{796,480},{554,192},{841,192},{242,555},{556,327},{793,327},{559,797},{560,4},{4,736},{561,697},{562,903},{564,971},{284,565},{284,856},{566,393},{393,444},{444,967},{567,259},{568,72},{970,570},{978,574},{987,578},{1055,579},{583,532},{206,532},{206,78},{706,78},{585,826},{658,591},{594,509},{595,971},{872,596},{196,598},{196,632},{600,942},{601,850},{602,754},{262,604},{818,262},{607,1042},{792,608},{609,258},{61,258},{610,921},{611,372},{1026,372},{1009,614},{637,615},{966,624},{626,657},{96,627},{628,952},{629,318},{632,338},{338,646},{633,164},{164,587},{709,587},{905,635},{636,812},{382,637},{291,640},{641,519},{527,642},{388,527},{388,844},{644,928},{645,1071},{825,646},{346,650},{492,655},{492,166},{588,166},{588,944},{656,457},{457,314},{111,314},{1016,111},{658,422},{478,659},{703,662},{273,663},{965,664},{666,475},{667,430},{430,187},{668,877},{62,670},{8,671},{516,672},{177,516},{939,676},{677,811},{874,678},{679,908},{685,83},{987,83},{686,143},{760,690},{692,358},{107,696},{107,347},{698,807},{552,701},{705,1035},{707,952},{580,710},{1034,711},{7,713},{717,1065},{147,718},{849,720},{67,725},{67,127},{727,933},{728,865},{730,941},{970,733},{44,735},{133,738},{308,740},{308,942},{1000,742},{709,743},{709,675},{1033,675},{746,910},{750,977},{343,752},{967,343},{753,225},{345,755},{787,345},{759,981},{762,905},{763,881},{764,905},{765,920},{767,271},{271,157},{201,157},{201,558},{294,770},{294,305},{305,1016},{360,771},{117,772},{773,17},{775,571},{571,993},{1064,776},{778,359},{779,15},{15,199},{660,199},{923,780},{507,784},{507,160},{160,873},{785,417},{417,1061},{787,757},{450,757},{697,789},{790,959},{793,63},{965,795},{964,798},{825,799},{800,719},{719,525},{143,525},{81,143},{802,63},{301,63},{437,804},{806,995},{451,807},{809,973},{883,810},{812,473},{813,141},{613,814},{613,623},{623,442},{815,454},{454,697},{150,697},{1008,150},{127,816},{296,127},{468,296},{468,1},{1,387},{387,410},{1004,818},{819,158},{708,820},{176,708},{176,353},{71,822},{71,1005},{823,549},{621,824},{47,621},{138,825},{826,182},{96,827},{829,425},{486,830},{831,161},{211,832},{576,211},{833,370},{26,370},{26,729},{729,682},{654,834},{835,582},{21,582},{21,682},{682,1037},{838,463},{298,463},{843,473},{473,1054},{845,407},{848,236},{322,236},{40,851},{40,441},{181,441},{956,852},{854,1067},{97,855},{97,193},{193,681},{307,858},{322,307},{859,932},{860,437},{437,576},{862,557},{1044,863},{699,865},{872,866},{867,966},{1023,869},{871,981},{530,873},{951,875},{878,318},{880,183},{586,183},{557,586},{620,557},{620,930},{881,318},{828,318},{242,882},{1046,242},{883,13},{13,935},{884,905},{606,885},{219,606},{219,416},{416,726},{52,726},{52,188},{355,888},{353,355},{353,72},{153,72},{37,153},{889,41},{584,41},{363,584},{363,313},{890,96},{96,1007},{715,891},{1020,893},{894,382},{382,870},{870,184},{706,899},{128,706},{653,901},{903,992},{907,1073},{908,422},{563,909},{937,563},{910,887},{887,179},{179,299},{470,911},{182,470},{184,182},{846,913},{435,915},{917,405},{769,405},{1018,919},{920,287},{737,921},{737,747},{248,747},{580,248},{580,796},{948,922},{141,923},{924,141},{404,924},{630,925},{926,181},{181,110},{110,309},{861,928},{861,306},{630,929},{630,758},{590,931},{590,837},{934,46},{953,46},{940,475},{792,475},{792,877},{109,941},{634,109},{512,634},{512,461},{1072,461},{943,249},{474,249},{886,474},{950,945},{879,947},{879,298},{79,298},{34,949},{34,133},{950,147},{998,952},{577,953},{273,577},{572,273},{983,572},{955,649},{649,721},{721,91},{91,53},{53,359},{769,359},{957,138},{348,958},{348,948},{508,948},{36,961},{964,691},{935,691},{300,935},{618,300},{132,966},{744,132},{147,967},{147,301},{699,968},{432,699},{432,415},{415,654},{420,654},{420,494},{260,494},{44,260},{44,837},{837,853},{188,969},{188,165},{33,165},{299,33},{278,299},{581,278},{912,581},{970,876},{876,425},{689,425},{689,1039},{971,597},{597,170},{161,170},{877,161},{16,877},{937,16},{528,973},{184,528},{975,17},{976,573},{977,760},{760,821},{937,978},{117,979},{217,981},{982,731},{731,412},{704,412},{704,140},{936,983},{936,140},{140,930},{221,930},{221,534},{534,599},{985,32},{986,722},{619,722},{673,988},{673,450},{990,974},{724,974},{724,45},{135,45},{868,991},{868,306},{993,681},{381,681},{841,381},{841,316},{900,316},{531,900},{781,531},{781,119},{119,526},{526,433},{994,902},{995,376},{376,622},{972,622},{213,972},{213,898},{274,898},{197,274},{996,791},{517,997},{856,517},{999,939},{716,939},{716,2},{2,1027},{418,1000},{418,1006},{1070,1001},{1002,569},{674,569},{31,674},{616,31},{766,616},{766,225},{225,839},{576,1005},{576,135},{1006,467},{467,684},{558,684},{558,758},{954,758},{954,317},{317,498},{1007,811},{247,811},{247,272},{272,906},{1008,210},{357,1009},{872,357},{892,872},{1010,768},{135,1011},{549,1012},{549,334},{874,334},{1014,243},{243,186},{702,186},{99,702},{1066,1016},{1018,128},{82,128},{82,840},{1019,918},{1021,471},{421,471},{980,1022},{1073,980},{1013,1023},{1013,309},{286,1024},{801,1025},{801,402},{520,402},{520,844},{57,844},{1027,173},{942,173},{1028,464},{464,745},{777,745},{777,625},{625,347},{347,1043},{7,1029},{478,1030},{1031,652},{652,20},{1040,20},{828,1032},{828,403},{403,456},{456,1055},{1033,643},{619,1034},{619,842},{493,842},{493,311},{422,1035},{1036,612},{1039,364},{693,1041},{631,1042},{904,1043},{754,904},{754,313},{744,1044},{395,744},{469,1045},{469,29},{29,864},{821,864},{821,786},{786,495},{902,495},{1046,121},{803,121},{892,803},{694,892},{508,694},{194,508},{194,794},{794,715},{1047,1004},{1004,315},{749,315},{749,451},{451,703},{423,703},{1048,769},{322,769},{748,322},{748,639},{1049,519},{395,519},{808,395},{349,808},{349,965},{99,965},{423,99},{79,1050},{1051,379},{379,450},{450,133},{669,133},{669,886},{1003,886},{207,1003},{207,1071},{1052,599},{599,360},{360,476},{409,1053},{364,1054},{937,364},{700,937},{700,874},{302,874},{302,476},{81,476},{81,413},{187,413},{187,177},{210,177},{912,210},{1055,846},{846,593},{963,593},{428,963},{817,428},{1056,680},{5,680},{5,17},{17,220},{639,220},{639,105},{1058,651},{422,651},{422,905},{905,1069},{389,1060},{389,409},{638,409},{1061,665},{665,74},{74,66},{683,66},{1057,1062},{1063,661},{1026,661},{839,1026},{839,840},{840,1037},{1037,942},{618,942},{618,10},{783,10},{1059,1064},{1059,7},{47,7},{47,89},{390,89},{390,847},{847,946},{36,946},{36,61},{984,61},{817,984},{817,433},{433,506},{506,358},{306,1065},{306,404},{404,715},{259,715},{259,612},{612,216},{216,291},{291,932},{932,956},{956,311},{311,92},{92,126},{103,1066},{788,1067},{138,788},{138,385},{23,385},{530,23},{530,100},{509,100},{1068,552},{1069,712},{712,407},{1070,286},{1071,732},{638,732},{605,638},{605,734},{1040,734},{902,1040},{902,552},{552,51},{653,1072},{653,739},{836,739},{120,836},{120,916},{466,916},{1073,547},{547,287},{287,159},{159,933},{933,87},{1015,87},{783,1015},{783,214},{214,918},{918,203},{203,912},{501,1074},{501,761},{254,761},{1020,254},{1020,313},{589,313},{1075,1038},{1038,8},{279,8},{358,279},{603,358},{603,895},{895,912},{912,346},{346,1017},{1057,1017},{1057,987},{987,466},{466,631},{421,631},{151,421},{1076,944},{944,617},{509,617},{509,62},{736,62},{736,435},{435,695},{438,695},{234,438},{234,791},{797,791},{683,797},{683,896},{896,478},{478,407},{693,407},{693,117},{117,27},{25,27},{25,573},{37,573},{850,37},{88,850},{88,227},{185,227},{751,185},{751,423},{423,103},{103,424},{906,424},{906,301},{301,938},{79,938},{79,992},{992,657},{657,660},{126,660},{647,126},{782,647},{687,782},{687,167},{167,460},{410,460},{406,410},{406,714},{796,714},{129,796},{648,129},{648,592},{592,217},{217,51},{927,51},{927,293},{293,237},{286,237},{286,959},{486,959},{136,486},{136,768},{768,57},{32,57},{442,32},{442,135},{135,914},{914,48},{265,1077},{857,265},{589,857},{989,589},{856,989},{856,488},{48,488},{951,48},{105,951},{105,264},{264,643},{400,643},{741,400},{741,184},{184,158},{158,853},{853,960},{414,960},{575,414},{575,151},{151,212},{212,202},{328,202},{328,54},{101,54},{723,101},{723,849},{498,849},{498,774},{774,152},{998,152},{756,998},{756,805},{897,805},{962,897},{11,962},{401,11},{197,401},{197,688},{688,309},{538,309},{1078,538}}}
    };

    for (auto& [n, k, edge]: tests) {
        const auto res {maximumValueSum(n, k, edge)};

        cout << "RES: " << res << endl;
    }

    return 1;
}